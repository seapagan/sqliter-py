<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=../explicit/ rel=prev><link href=../../many-to-many/ rel=next><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.14"><title>ORM Foreign Keys - SQLiter</title><link rel=stylesheet href=../../../assets/stylesheets/main.342714a4.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel="stylesheet" href="../../../assets/external/fonts.googleapis.com/css.49ea35f2.css"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../css/extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head><body dir=ltr data-md-color-scheme=default data-md-color-primary=light-blue data-md-color-accent=blue><input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off><input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off><label class=md-overlay for=__drawer></label><div data-md-component=skip><a href=#orm-foreign-keys class=md-skip> Skip to content </a></div><div data-md-component=announce></div><header class=md-header data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a href=../../.. title=SQLiter class="md-header__button md-logo" aria-label=SQLiter data-md-component=logo><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg></a><label class="md-header__button md-icon" for=__drawer><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> SQLiter </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> ORM Foreign Keys </span></div></div></div><label class="md-header__button md-icon" for=__search><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required><label class="md-search__icon md-icon" for=__search><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg></label><nav class=md-search__options aria-label=Search><button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button></nav></form><div class=md-search__output><div class=md-search__scrollwrap tabindex=0 data-md-scrollfix><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta> Initializing search </div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a href="https://github.com/seapagan/sqliter-py" title="Go to repository" class="md-source" data-md-component="source"><div class="md-source__icon md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg></div><div class=md-source__repository> SQLiter </div></a></div></nav></header><div class=md-container data-md-component=container><nav class=md-tabs aria-label=Tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a href=../../.. class=md-tabs__link> Home </a></li><li class="md-tabs__item md-tabs__item--active"><a href=../../guide/ class=md-tabs__link> Guide </a></li><li class=md-tabs__item><a href=../../../api-reference/ class=md-tabs__link> API Reference </a></li><li class=md-tabs__item><a href=../../../tui-demo/ class=md-tabs__link> Interactive Demo </a></li><li class=md-tabs__item><a href=../../../changelog/ class=md-tabs__link> Changelog </a></li><li class=md-tabs__item><a href=../../../contributing/ class=md-tabs__link> Contributing </a></li><li class=md-tabs__item><a href=../../../todo/ class=md-tabs__link> TODO List </a></li><li class=md-tabs__item><a href=../../../license/ class=md-tabs__link> License </a></li></ul></div></nav><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a href=../../.. title=SQLiter class="md-nav__button md-logo" aria-label=SQLiter data-md-component=logo><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg></a> SQLiter </label><div class=md-nav__source><a href="https://github.com/seapagan/sqliter-py" title="Go to repository" class="md-source" data-md-component="source"><div class="md-source__icon md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg></div><div class=md-source__repository> SQLiter </div></a></div><ul class=md-nav__list data-md-scrollfix><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1><div class="md-nav__link md-nav__container"><a href=../../.. class="md-nav__link "><span class=md-ellipsis> Home </span></a><label class="md-nav__link " for=__nav_1 id=__nav_1_label tabindex=0><span class="md-nav__icon md-icon"></span></label></div><nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false><label class=md-nav__title for=__nav_1><span class="md-nav__icon md-icon"></span> Home </label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../../../installation/ class=md-nav__link><span class=md-ellipsis> Installation </span></a></li><li class=md-nav__item><a href=../../../quickstart/ class=md-nav__link><span class=md-ellipsis> Quick Start </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked><label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex><span class=md-ellipsis> Guide </span><span class="md-nav__icon md-icon"></span></label><nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true><label class=md-nav__title for=__nav_2><span class="md-nav__icon md-icon"></span> Guide </label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../../guide/ class=md-nav__link><span class=md-ellipsis> Overview </span></a></li><li class=md-nav__item><a href=../../models/ class=md-nav__link><span class=md-ellipsis> Models </span></a></li><li class=md-nav__item><a href=../../connecting/ class=md-nav__link><span class=md-ellipsis> Connect to a Database </span></a></li><li class=md-nav__item><a href=../../properties/ class=md-nav__link><span class=md-ellipsis> Properties </span></a></li><li class=md-nav__item><a href=../../tables/ class=md-nav__link><span class=md-ellipsis> Table Operations </span></a></li><li class=md-nav__item><a href=../../data-operations/ class=md-nav__link><span class=md-ellipsis> Data Operations </span></a></li><li class=md-nav__item><a href=../../transactions/ class=md-nav__link><span class=md-ellipsis> Transactions </span></a></li><li class=md-nav__item><a href=../../filtering/ class=md-nav__link><span class=md-ellipsis> Filtering Results </span></a></li><li class=md-nav__item><a href=../../ordering/ class=md-nav__link><span class=md-ellipsis> Ordering </span></a></li><li class=md-nav__item><a href=../../fields/ class=md-nav__link><span class=md-ellipsis> Field Control </span></a></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_11 checked><label class=md-nav__link for=__nav_2_11 id=__nav_2_11_label tabindex><span class=md-ellipsis> Foreign Keys </span><span class="md-nav__icon md-icon"></span></label><nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_11_label aria-expanded=true><label class=md-nav__title for=__nav_2_11><span class="md-nav__icon md-icon"></span> Foreign Keys </label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../ class=md-nav__link><span class=md-ellipsis> Overview </span></a></li><li class=md-nav__item><a href=../explicit/ class=md-nav__link><span class=md-ellipsis> Explicit Foreign Keys </span></a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" type=checkbox id=__toc><label class="md-nav__link md-nav__link--active" for=__toc><span class=md-ellipsis> ORM Foreign Keys </span><span class="md-nav__icon md-icon"></span></label><a href=./ class="md-nav__link md-nav__link--active"><span class=md-ellipsis> ORM Foreign Keys </span></a><nav class="md-nav md-nav--secondary" aria-label="Table of contents"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents </label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a href=#defining-orm-foreign-keys class=md-nav__link><span class=md-ellipsis> Defining ORM Foreign Keys </span></a></li><li class=md-nav__item><a href=#database-context class=md-nav__link><span class=md-ellipsis> Database Context </span></a></li><li class=md-nav__item><a href=#lazy-loading class=md-nav__link><span class=md-ellipsis> Lazy Loading </span></a></li><li class=md-nav__item><a href=#caching-behavior class=md-nav__link><span class=md-ellipsis> Caching Behavior </span></a></li><li class=md-nav__item><a href=#performance-considerations class=md-nav__link><span class=md-ellipsis> Performance Considerations </span></a><nav class=md-nav aria-label="Performance Considerations"><ul class=md-nav__list><li class=md-nav__item><a href=#the-n1-query-problem class=md-nav__link><span class=md-ellipsis> The N+1 Query Problem </span></a></li><li class=md-nav__item><a href=#eager-loading-with-select_related class=md-nav__link><span class=md-ellipsis> Eager Loading with select_related() </span></a><nav class=md-nav aria-label="Eager Loading with select_related()"><ul class=md-nav__list><li class=md-nav__item><a href=#single-level-relationships class=md-nav__link><span class=md-ellipsis> Single-Level Relationships </span></a></li><li class=md-nav__item><a href=#nested-relationships class=md-nav__link><span class=md-ellipsis> Nested Relationships </span></a></li><li class=md-nav__item><a href=#multiple-relationships class=md-nav__link><span class=md-ellipsis> Multiple Relationships </span></a></li></ul></nav></li><li class=md-nav__item><a href=#eager-loading-reverse-relationships-with-prefetch_related class=md-nav__link><span class=md-ellipsis> Eager Loading Reverse Relationships with prefetch_related() </span></a><nav class=md-nav aria-label="Eager Loading Reverse Relationships with prefetch_related()"><ul class=md-nav__list><li class=md-nav__item><a href=#multiple-prefetch-paths class=md-nav__link><span class=md-ellipsis> Multiple Prefetch Paths </span></a></li><li class=md-nav__item><a href=#combining-with-select_related class=md-nav__link><span class=md-ellipsis> Combining with select_related() </span></a></li><li class=md-nav__item><a href=#chaining-with-filter-order-and-limit class=md-nav__link><span class=md-ellipsis> Chaining with filter, order, and limit </span></a></li><li class=md-nav__item><a href=#prefetched-data-api class=md-nav__link><span class=md-ellipsis> Prefetched Data API </span></a></li></ul></nav></li><li class=md-nav__item><a href=#relationship-filter-traversal class=md-nav__link><span class=md-ellipsis> Relationship Filter Traversal </span></a><nav class=md-nav aria-label="Relationship Filter Traversal"><ul class=md-nav__list><li class=md-nav__item><a href=#combining-with-select_related_1 class=md-nav__link><span class=md-ellipsis> Combining with select_related() </span></a></li></ul></nav></li></ul></nav></li><li class=md-nav__item><a href=#null-foreign-keys class=md-nav__link><span class=md-ellipsis> Null Foreign Keys </span></a><nav class=md-nav aria-label="Null Foreign Keys"><ul class=md-nav__list><li class=md-nav__item><a href=#auto-detecting-nullable-fks-preferred class=md-nav__link><span class=md-ellipsis> Auto-Detecting Nullable FKs (Preferred) </span></a></li></ul></nav></li><li class=md-nav__item><a href=#setting-foreign-key-values class=md-nav__link><span class=md-ellipsis> Setting Foreign Key Values </span></a></li><li class=md-nav__item><a href=#reverse-relationships class=md-nav__link><span class=md-ellipsis> Reverse Relationships </span></a><nav class=md-nav aria-label="Reverse Relationships"><ul class=md-nav__list><li class=md-nav__item><a href=#available-methods class=md-nav__link><span class=md-ellipsis> Available Methods </span></a></li><li class=md-nav__item><a href=#filtering-reverse-relationships class=md-nav__link><span class=md-ellipsis> Filtering Reverse Relationships </span></a></li><li class=md-nav__item><a href=#custom-related-name class=md-nav__link><span class=md-ellipsis> Custom Related Name </span></a></li></ul></nav></li><li class=md-nav__item><a href=#cascade-delete-behavior class=md-nav__link><span class=md-ellipsis> Cascade Delete Behavior </span></a></li><li class=md-nav__item><a href=#foreign-key-actions class=md-nav__link><span class=md-ellipsis> Foreign Key Actions </span></a></li><li class=md-nav__item><a href=#common-issues-and-gotchas class=md-nav__link><span class=md-ellipsis> Common Issues and Gotchas </span></a><nav class=md-nav aria-label="Common Issues and Gotchas"><ul class=md-nav__list><li class=md-nav__item><a href=#database-context-not-set class=md-nav__link><span class=md-ellipsis> Database Context Not Set </span></a></li><li class=md-nav__item><a href=#lazyloader-not-hashable class=md-nav__link><span class=md-ellipsis> LazyLoader Not Hashable </span></a></li><li class=md-nav__item><a href=#stale-cache-after-manual-updates class=md-nav__link><span class=md-ellipsis> Stale Cache After Manual Updates </span></a></li><li class=md-nav__item><a href=#foreign-keys-in-filters class=md-nav__link><span class=md-ellipsis> Foreign Keys in Filters </span></a></li></ul></nav></li><li class=md-nav__item><a href=#complete-example class=md-nav__link><span class=md-ellipsis> Complete Example </span></a></li></ul></nav></li></ul></nav></li><li class=md-nav__item><a href=../../many-to-many/ class=md-nav__link><span class=md-ellipsis> Many-to-Many </span></a></li><li class=md-nav__item><a href=../../caching/ class=md-nav__link><span class=md-ellipsis> Caching </span></a></li><li class=md-nav__item><a href=../../exceptions/ class=md-nav__link><span class=md-ellipsis> Exceptions </span></a></li><li class=md-nav__item><a href=../../debug/ class=md-nav__link><span class=md-ellipsis> Debug Logging </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3><div class="md-nav__link md-nav__container"><a href=../../../api-reference/ class="md-nav__link "><span class=md-ellipsis> API Reference </span></a><label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0><span class="md-nav__icon md-icon"></span></label></div><nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false><label class=md-nav__title for=__nav_3><span class="md-nav__icon md-icon"></span> API Reference </label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../../../api-reference/sqliterdb/ class=md-nav__link><span class=md-ellipsis> SqliterDB </span></a></li><li class=md-nav__item><a href=../../../api-reference/base-model/ class=md-nav__link><span class=md-ellipsis> BaseDBModel </span></a></li><li class=md-nav__item><a href=../../../api-reference/query-builder/ class=md-nav__link><span class=md-ellipsis> QueryBuilder </span></a></li><li class=md-nav__item><a href=../../../api-reference/foreign-keys/ class=md-nav__link><span class=md-ellipsis> Foreign Keys </span></a></li><li class=md-nav__item><a href=../../../api-reference/orm/ class=md-nav__link><span class=md-ellipsis> ORM Mode </span></a></li><li class=md-nav__item><a href=../../../api-reference/many-to-many/ class=md-nav__link><span class=md-ellipsis> Many-to-Many </span></a></li><li class=md-nav__item><a href=../../../api-reference/exceptions/ class=md-nav__link><span class=md-ellipsis> Exceptions </span></a></li><li class=md-nav__item><a href=../../../api-reference/helpers/ class=md-nav__link><span class=md-ellipsis> Helpers & Constants </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4><div class="md-nav__link md-nav__container"><a href=../../../tui-demo/ class="md-nav__link "><span class=md-ellipsis> Interactive Demo </span></a><label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0><span class="md-nav__icon md-icon"></span></label></div><nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false><label class=md-nav__title for=__nav_4><span class="md-nav__icon md-icon"></span> Interactive Demo </label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a href=../../../tui-demo/connection/ class=md-nav__link><span class=md-ellipsis> Database Connection </span></a></li><li class=md-nav__item><a href=../../../tui-demo/models/ class=md-nav__link><span class=md-ellipsis> Models </span></a></li><li class=md-nav__item><a href=../../../tui-demo/crud/ class=md-nav__link><span class=md-ellipsis> CRUD Operations </span></a></li><li class=md-nav__item><a href=../../../tui-demo/filters/ class=md-nav__link><span class=md-ellipsis> Filtering </span></a></li><li class=md-nav__item><a href=../../../tui-demo/string-filters/ class=md-nav__link><span class=md-ellipsis> String Filters </span></a></li><li class=md-nav__item><a href=../../../tui-demo/field-selection/ class=md-nav__link><span class=md-ellipsis> Field Selection </span></a></li><li class=md-nav__item><a href=../../../tui-demo/results/ class=md-nav__link><span class=md-ellipsis> Query Results </span></a></li><li class=md-nav__item><a href=../../../tui-demo/ordering/ class=md-nav__link><span class=md-ellipsis> Ordering </span></a></li><li class=md-nav__item><a href=../../../tui-demo/constraints/ class=md-nav__link><span class=md-ellipsis> Constraints </span></a></li><li class=md-nav__item><a href=../../../tui-demo/orm/ class=md-nav__link><span class=md-ellipsis> ORM Features </span></a></li><li class=md-nav__item><a href=../../../tui-demo/caching/ class=md-nav__link><span class=md-ellipsis> Caching </span></a></li><li class=md-nav__item><a href=../../../tui-demo/timestamps/ class=md-nav__link><span class=md-ellipsis> Auto Timestamps </span></a></li><li class=md-nav__item><a href=../../../tui-demo/transactions/ class=md-nav__link><span class=md-ellipsis> Transactions </span></a></li><li class=md-nav__item><a href=../../../tui-demo/errors/ class=md-nav__link><span class=md-ellipsis> Error Handling </span></a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5><div class="md-nav__link md-nav__container"><a href=../../../changelog/ class="md-nav__link "><span class=md-ellipsis> Changelog </span></a></div><nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false><label class=md-nav__title for=__nav_5><span class="md-nav__icon md-icon"></span> Changelog </label><ul class=md-nav__list data-md-scrollfix></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6><div class="md-nav__link md-nav__container"><a href=../../../contributing/ class="md-nav__link "><span class=md-ellipsis> Contributing </span></a></div><nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false><label class=md-nav__title for=__nav_6><span class="md-nav__icon md-icon"></span> Contributing </label><ul class=md-nav__list data-md-scrollfix></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7><div class="md-nav__link md-nav__container"><a href=../../../todo/ class="md-nav__link "><span class=md-ellipsis> TODO List </span></a></div><nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false><label class=md-nav__title for=__nav_7><span class="md-nav__icon md-icon"></span> TODO List </label><ul class=md-nav__list data-md-scrollfix></ul></nav></li><li class=md-nav__item><a href=../../../license/ class=md-nav__link><span class=md-ellipsis> License </span></a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--secondary" aria-label="Table of contents"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents </label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a href=#defining-orm-foreign-keys class=md-nav__link><span class=md-ellipsis> Defining ORM Foreign Keys </span></a></li><li class=md-nav__item><a href=#database-context class=md-nav__link><span class=md-ellipsis> Database Context </span></a></li><li class=md-nav__item><a href=#lazy-loading class=md-nav__link><span class=md-ellipsis> Lazy Loading </span></a></li><li class=md-nav__item><a href=#caching-behavior class=md-nav__link><span class=md-ellipsis> Caching Behavior </span></a></li><li class=md-nav__item><a href=#performance-considerations class=md-nav__link><span class=md-ellipsis> Performance Considerations </span></a><nav class=md-nav aria-label="Performance Considerations"><ul class=md-nav__list><li class=md-nav__item><a href=#the-n1-query-problem class=md-nav__link><span class=md-ellipsis> The N+1 Query Problem </span></a></li><li class=md-nav__item><a href=#eager-loading-with-select_related class=md-nav__link><span class=md-ellipsis> Eager Loading with select_related() </span></a><nav class=md-nav aria-label="Eager Loading with select_related()"><ul class=md-nav__list><li class=md-nav__item><a href=#single-level-relationships class=md-nav__link><span class=md-ellipsis> Single-Level Relationships </span></a></li><li class=md-nav__item><a href=#nested-relationships class=md-nav__link><span class=md-ellipsis> Nested Relationships </span></a></li><li class=md-nav__item><a href=#multiple-relationships class=md-nav__link><span class=md-ellipsis> Multiple Relationships </span></a></li></ul></nav></li><li class=md-nav__item><a href=#eager-loading-reverse-relationships-with-prefetch_related class=md-nav__link><span class=md-ellipsis> Eager Loading Reverse Relationships with prefetch_related() </span></a><nav class=md-nav aria-label="Eager Loading Reverse Relationships with prefetch_related()"><ul class=md-nav__list><li class=md-nav__item><a href=#multiple-prefetch-paths class=md-nav__link><span class=md-ellipsis> Multiple Prefetch Paths </span></a></li><li class=md-nav__item><a href=#combining-with-select_related class=md-nav__link><span class=md-ellipsis> Combining with select_related() </span></a></li><li class=md-nav__item><a href=#chaining-with-filter-order-and-limit class=md-nav__link><span class=md-ellipsis> Chaining with filter, order, and limit </span></a></li><li class=md-nav__item><a href=#prefetched-data-api class=md-nav__link><span class=md-ellipsis> Prefetched Data API </span></a></li></ul></nav></li><li class=md-nav__item><a href=#relationship-filter-traversal class=md-nav__link><span class=md-ellipsis> Relationship Filter Traversal </span></a><nav class=md-nav aria-label="Relationship Filter Traversal"><ul class=md-nav__list><li class=md-nav__item><a href=#combining-with-select_related_1 class=md-nav__link><span class=md-ellipsis> Combining with select_related() </span></a></li></ul></nav></li></ul></nav></li><li class=md-nav__item><a href=#null-foreign-keys class=md-nav__link><span class=md-ellipsis> Null Foreign Keys </span></a><nav class=md-nav aria-label="Null Foreign Keys"><ul class=md-nav__list><li class=md-nav__item><a href=#auto-detecting-nullable-fks-preferred class=md-nav__link><span class=md-ellipsis> Auto-Detecting Nullable FKs (Preferred) </span></a></li></ul></nav></li><li class=md-nav__item><a href=#setting-foreign-key-values class=md-nav__link><span class=md-ellipsis> Setting Foreign Key Values </span></a></li><li class=md-nav__item><a href=#reverse-relationships class=md-nav__link><span class=md-ellipsis> Reverse Relationships </span></a><nav class=md-nav aria-label="Reverse Relationships"><ul class=md-nav__list><li class=md-nav__item><a href=#available-methods class=md-nav__link><span class=md-ellipsis> Available Methods </span></a></li><li class=md-nav__item><a href=#filtering-reverse-relationships class=md-nav__link><span class=md-ellipsis> Filtering Reverse Relationships </span></a></li><li class=md-nav__item><a href=#custom-related-name class=md-nav__link><span class=md-ellipsis> Custom Related Name </span></a></li></ul></nav></li><li class=md-nav__item><a href=#cascade-delete-behavior class=md-nav__link><span class=md-ellipsis> Cascade Delete Behavior </span></a></li><li class=md-nav__item><a href=#foreign-key-actions class=md-nav__link><span class=md-ellipsis> Foreign Key Actions </span></a></li><li class=md-nav__item><a href=#common-issues-and-gotchas class=md-nav__link><span class=md-ellipsis> Common Issues and Gotchas </span></a><nav class=md-nav aria-label="Common Issues and Gotchas"><ul class=md-nav__list><li class=md-nav__item><a href=#database-context-not-set class=md-nav__link><span class=md-ellipsis> Database Context Not Set </span></a></li><li class=md-nav__item><a href=#lazyloader-not-hashable class=md-nav__link><span class=md-ellipsis> LazyLoader Not Hashable </span></a></li><li class=md-nav__item><a href=#stale-cache-after-manual-updates class=md-nav__link><span class=md-ellipsis> Stale Cache After Manual Updates </span></a></li><li class=md-nav__item><a href=#foreign-keys-in-filters class=md-nav__link><span class=md-ellipsis> Foreign Keys in Filters </span></a></li></ul></nav></li><li class=md-nav__item><a href=#complete-example class=md-nav__link><span class=md-ellipsis> Complete Example </span></a></li></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><h1 id=orm-foreign-keys>ORM Foreign Keys</h1><p>ORM-style foreign keys provide lazy loading and reverse relationships, similar to Django or SQLAlchemy. This approach allows you to access related objects directly (e.g., <code>book.author.name</code>) without manual queries.</p><p>For the simpler explicit approach with manual ID management, see <a href=../explicit/ >Explicit Foreign Keys</a>.</p><h2 id=defining-orm-foreign-keys>Defining ORM Foreign Keys</h2><p>Import from <code>sqliter.orm</code> instead of <code>sqliter.model</code>:</p><div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sqliter</span><span class=w> </span><span class=kn>import</span> <span class=n>SqliterDB</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sqliter.orm</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseDBModel</span><span class=p>,</span> <span class=n>ForeignKey</span>

<span class=k>class</span><span class=w> </span><span class=nc>Author</span><span class=p>(</span><span class=n>BaseDBModel</span><span class=p>):</span>
    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>email</span><span class=p>:</span> <span class=nb>str</span>

<span class=k>class</span><span class=w> </span><span class=nc>Book</span><span class=p>(</span><span class=n>BaseDBModel</span><span class=p>):</span>
    <span class=n>title</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>author</span><span class=p>:</span> <span class=n>ForeignKey</span><span class=p>[</span><span class=n>Author</span><span class=p>]</span> <span class=o>=</span> <span class=n>ForeignKey</span><span class=p>(</span><span class=n>Author</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=s2>&quot;CASCADE&quot;</span><span class=p>)</span>

<span class=n>db</span> <span class=o>=</span> <span class=n>SqliterDB</span><span class=p>(</span><span class=s2>&quot;:memory:&quot;</span><span class=p>)</span>
<span class=n>db</span><span class=o>.</span><span class=n>create_table</span><span class=p>(</span><span class=n>Author</span><span class=p>)</span>
<span class=n>db</span><span class=o>.</span><span class=n>create_table</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span>
</code></pre></div><div class="admonition note"><p class=admonition-title>Note</p><p>When using ORM foreign keys, SQLiter automatically creates an <code>author_id</code> field in the database. You define <code>author</code> (without <code>_id</code>) in your model and access it for lazy loading.</p></div><h2 id=database-context>Database Context</h2><p>ORM features require a database context to execute queries. SQLiter automatically sets <code>db_context</code> on model instances returned from database operations:</p><div class=highlight><pre><span></span><code><span class=c1># db_context is set automatically</span>
<span class=n>book</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>Book</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>  <span class=c1># Works - db_context was set by db.get()</span>

<span class=c1># Manual instances need db_context set explicitly</span>
<span class=n>book</span> <span class=o>=</span> <span class=n>Book</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s2>&quot;My Book&quot;</span><span class=p>,</span> <span class=n>author_id</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=n>book</span><span class=o>.</span><span class=n>db_context</span> <span class=o>=</span> <span class=n>db</span>  <span class=c1># Set manually for lazy loading to work</span>
<span class=nb>print</span><span class=p>(</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</code></pre></div><h2 id=lazy-loading>Lazy Loading</h2><p>When you access a foreign key field, SQLiter automatically loads the related object from the database:</p><div class=highlight><pre><span></span><code><span class=c1># Insert data</span>
<span class=n>author</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>Author</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;Jane Austen&quot;</span><span class=p>,</span> <span class=n>email</span><span class=o>=</span><span class=s2>&quot;jane@example.com&quot;</span><span class=p>))</span>
<span class=n>book</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>Book</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s2>&quot;Pride and Prejudice&quot;</span><span class=p>,</span> <span class=n>author</span><span class=o>=</span><span class=n>author</span><span class=p>))</span>

<span class=c1># Fetch the book</span>
<span class=n>book</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>Book</span><span class=p>,</span> <span class=n>book</span><span class=o>.</span><span class=n>pk</span><span class=p>)</span>

<span class=c1># Lazy loading - queries database on first access</span>
<span class=nb>print</span><span class=p>(</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>  <span class=c1># &quot;Jane Austen&quot;</span>
<span class=nb>print</span><span class=p>(</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>email</span><span class=p>)</span>  <span class=c1># &quot;jane@example.com&quot;</span>
</code></pre></div><p>The related object is only loaded when you access an attribute. If you never access <code>book.author</code>, no additional query is made.</p><h2 id=caching-behavior>Caching Behavior</h2><p>Once loaded, the related object is cached on the instance. Repeated access returns the same object:</p><div class=highlight><pre><span></span><code><span class=n>book</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>Book</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>

<span class=c1># First access loads from database</span>
<span class=n>author1</span> <span class=o>=</span> <span class=n>book</span><span class=o>.</span><span class=n>author</span>
<span class=c1># Second access returns cached object (no query)</span>
<span class=n>author2</span> <span class=o>=</span> <span class=n>book</span><span class=o>.</span><span class=n>author</span>

<span class=c1># Same object instance</span>
<span class=k>assert</span> <span class=n>author1</span> <span class=ow>is</span> <span class=n>author2</span>
</code></pre></div><h2 id=performance-considerations>Performance Considerations</h2><h3 id=the-n1-query-problem>The N+1 Query Problem</h3><p>When iterating over multiple objects and accessing their foreign key relationships, you can encounter the <strong>N+1 query problem</strong>. This happens when you make 1 query to fetch N objects, then N additional queries to fetch each related object:</p><div class=highlight><pre><span></span><code><span class=c1># Fetch 100 books (1 query)</span>
<span class=n>books</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>

<span class=c1># Accessing author for each book triggers a separate query (100 queries!)</span>
<span class=k>for</span> <span class=n>book</span> <span class=ow>in</span> <span class=n>books</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>book</span><span class=o>.</span><span class=n>title</span><span class=si>}</span><span class=s2> by </span><span class=si>{</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>  <span class=c1># ⚠️ N+1 problem</span>
</code></pre></div><p>In this example, SQLiter makes 101 database queries total: 1 to fetch all books, then 100 more queries (one per book) to fetch each author.</p><h3 id=eager-loading-with-select_related>Eager Loading with select_related()</h3><p>Use <code>select_related()</code> to fetch related objects in a single JOIN query instead of lazy loading:</p><div class=highlight><pre><span></span><code><span class=c1># Fetch books with authors in ONE query</span>
<span class=n>books</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span><span class=o>.</span><span class=n>select_related</span><span class=p>(</span><span class=s2>&quot;author&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>

<span class=c1># Access authors without triggering additional queries</span>
<span class=k>for</span> <span class=n>book</span> <span class=ow>in</span> <span class=n>books</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>book</span><span class=o>.</span><span class=n>title</span><span class=si>}</span><span class=s2> by </span><span class=si>{</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>  <span class=c1># ✅ No N+1 problem</span>
</code></pre></div><p>This executes a single JOIN query instead of 101 separate queries (1 for books, 100 for authors).</p><h4 id=single-level-relationships>Single-Level Relationships</h4><div class=highlight><pre><span></span><code><span class=c1># Load single relationship</span>
<span class=n>book</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span><span class=o>.</span><span class=n>select_related</span><span class=p>(</span><span class=s2>&quot;author&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_one</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>  <span class=c1># &quot;Jane Austen&quot; - already loaded</span>
</code></pre></div><h4 id=nested-relationships>Nested Relationships</h4><div class=highlight><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>Comment</span><span class=p>(</span><span class=n>BaseDBModel</span><span class=p>):</span>
    <span class=n>text</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>book</span><span class=p>:</span> <span class=n>ForeignKey</span><span class=p>[</span><span class=n>Book</span><span class=p>]</span> <span class=o>=</span> <span class=n>ForeignKey</span><span class=p>(</span><span class=n>Book</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=s2>&quot;CASCADE&quot;</span><span class=p>)</span>

<span class=n>db</span><span class=o>.</span><span class=n>create_table</span><span class=p>(</span><span class=n>Comment</span><span class=p>)</span>

<span class=c1># Load nested relationships using double underscore</span>
<span class=n>comment</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Comment</span><span class=p>)</span><span class=o>.</span><span class=n>select_related</span><span class=p>(</span><span class=s2>&quot;book__author&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_one</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=n>comment</span><span class=o>.</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>  <span class=c1># &quot;Jane&quot; - already loaded</span>
</code></pre></div><h4 id=multiple-relationships>Multiple Relationships</h4><div class=highlight><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>Publisher</span><span class=p>(</span><span class=n>BaseDBModel</span><span class=p>):</span>
    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span>

<span class=k>class</span><span class=w> </span><span class=nc>Book</span><span class=p>(</span><span class=n>BaseDBModel</span><span class=p>):</span>
    <span class=n>title</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>author</span><span class=p>:</span> <span class=n>ForeignKey</span><span class=p>[</span><span class=n>Author</span><span class=p>]</span> <span class=o>=</span> <span class=n>ForeignKey</span><span class=p>(</span><span class=n>Author</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=s2>&quot;CASCADE&quot;</span><span class=p>)</span>
    <span class=n>publisher</span><span class=p>:</span> <span class=n>ForeignKey</span><span class=p>[</span><span class=n>Publisher</span><span class=p>]</span> <span class=o>=</span> <span class=n>ForeignKey</span><span class=p>(</span><span class=n>Publisher</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=s2>&quot;CASCADE&quot;</span><span class=p>)</span>

<span class=c1># Load multiple relationships at once</span>
<span class=n>book</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span><span class=o>.</span><span class=n>select_related</span><span class=p>(</span><span class=s2>&quot;author&quot;</span><span class=p>,</span> <span class=s2>&quot;publisher&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_one</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>book</span><span class=o>.</span><span class=n>title</span><span class=si>}</span><span class=s2> by </span><span class=si>{</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> from </span><span class=si>{</span><span class=n>book</span><span class=o>.</span><span class=n>publisher</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</code></pre></div><h3 id=eager-loading-reverse-relationships-with-prefetch_related>Eager Loading Reverse Relationships with prefetch_related()</h3><p><code>select_related()</code> solves the N+1 problem for <strong>forward</strong> FK relationships (e.g., <code>book.author</code>) using JOINs. For <strong>reverse</strong> relationships (e.g., <code>author.books</code>), use <code>prefetch_related()</code> instead. It executes a second query to fetch all related objects and maps them back to the parent instances:</p><div class=highlight><pre><span></span><code><span class=c1># Fetch authors with all their books prefetched (2 queries total)</span>
<span class=n>authors</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Author</span><span class=p>)</span><span class=o>.</span><span class=n>prefetch_related</span><span class=p>(</span><span class=s2>&quot;books&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>

<span class=k>for</span> <span class=n>author</span> <span class=ow>in</span> <span class=n>authors</span><span class=p>:</span>
    <span class=c1># No additional query - data is already loaded</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> wrote </span><span class=si>{</span><span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>count</span><span class=p>()</span><span class=si>}</span><span class=s2> books&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>book</span> <span class=ow>in</span> <span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>():</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  - </span><span class=si>{</span><span class=n>book</span><span class=o>.</span><span class=n>title</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</code></pre></div><p>Without <code>prefetch_related()</code>, the loop above would execute 1 + N queries (one per author). With it, only 2 queries run regardless of how many authors exist.</p><h4 id=multiple-prefetch-paths>Multiple Prefetch Paths</h4><p>You can prefetch several reverse relationships at once:</p><div class=highlight><pre><span></span><code><span class=n>authors</span> <span class=o>=</span> <span class=p>(</span>
    <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Author</span><span class=p>)</span>
    <span class=o>.</span><span class=n>prefetch_related</span><span class=p>(</span><span class=s2>&quot;books&quot;</span><span class=p>,</span> <span class=s2>&quot;reviews&quot;</span><span class=p>)</span>
    <span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>
<span class=p>)</span>

<span class=k>for</span> <span class=n>author</span> <span class=ow>in</span> <span class=n>authors</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>count</span><span class=p>()</span><span class=si>}</span><span class=s2> books, &quot;</span>
          <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>author</span><span class=o>.</span><span class=n>reviews</span><span class=o>.</span><span class=n>count</span><span class=p>()</span><span class=si>}</span><span class=s2> reviews&quot;</span><span class=p>)</span>
</code></pre></div><h4 id=combining-with-select_related>Combining with select_related()</h4><p><code>prefetch_related()</code> and <code>select_related()</code> can coexist on the same query. Use <code>select_related()</code> for forward FKs and <code>prefetch_related()</code> for reverse FKs:</p><div class=highlight><pre><span></span><code><span class=n>authors</span> <span class=o>=</span> <span class=p>(</span>
    <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Author</span><span class=p>)</span>
    <span class=o>.</span><span class=n>select_related</span><span class=p>(</span><span class=s2>&quot;publisher&quot;</span><span class=p>)</span>     <span class=c1># forward FK - JOIN</span>
    <span class=o>.</span><span class=n>prefetch_related</span><span class=p>(</span><span class=s2>&quot;books&quot;</span><span class=p>)</span>       <span class=c1># reverse FK - 2nd query</span>
    <span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>
<span class=p>)</span>
</code></pre></div><h4 id=chaining-with-filter-order-and-limit>Chaining with filter, order, and limit</h4><p><code>prefetch_related()</code> works with all standard query methods:</p><div class=highlight><pre><span></span><code><span class=n>authors</span> <span class=o>=</span> <span class=p>(</span>
    <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Author</span><span class=p>)</span>
    <span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>name__startswith</span><span class=o>=</span><span class=s2>&quot;J&quot;</span><span class=p>)</span>
    <span class=o>.</span><span class=n>prefetch_related</span><span class=p>(</span><span class=s2>&quot;books&quot;</span><span class=p>)</span>
    <span class=o>.</span><span class=n>order</span><span class=p>(</span><span class=s2>&quot;name&quot;</span><span class=p>)</span>
    <span class=o>.</span><span class=n>limit</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
    <span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>
<span class=p>)</span>
</code></pre></div><h4 id=prefetched-data-api>Prefetched Data API</h4><p>Accessing a prefetched reverse relationship returns a <code>PrefetchedResult</code> instead of the usual <code>ReverseQuery</code>. It provides the same read interface:</p><div class=highlight><pre><span></span><code><span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>   <span class=c1># list of Book instances</span>
<span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>fetch_one</span><span class=p>()</span>   <span class=c1># first Book or None</span>
<span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>count</span><span class=p>()</span>       <span class=c1># number of books</span>
<span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>exists</span><span class=p>()</span>      <span class=c1># True if any books exist</span>
</code></pre></div><p>If you call <code>filter()</code> on a prefetched relationship, it falls back to a real database query:</p><div class=highlight><pre><span></span><code><span class=c1># Falls back to a DB query with a WHERE clause</span>
<span class=n>recent</span> <span class=o>=</span> <span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>year__gt</span><span class=o>=</span><span class=mi>2000</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>
</code></pre></div><div class="admonition note"><p class=admonition-title>Note</p><p><code>prefetch_related()</code> only works with <strong>reverse</strong> FK relationships and M2M relationships. For forward FKs (e.g., <code>book.author</code>), use <code>select_related()</code> instead. Passing a forward FK path raises <code>InvalidPrefetchError</code>.</p></div><div class="admonition tip"><p class=admonition-title>Tip</p><p><code>prefetch_related()</code> also works with many-to-many relationships. See <a href=../../many-to-many/#eager-loading-with-prefetch_related>Many-to-Many</a> for details.</p></div><h3 id=relationship-filter-traversal>Relationship Filter Traversal</h3><p>Filter on related object fields using double underscore (<code>__</code>) syntax:</p><div class=highlight><pre><span></span><code><span class=c1># Filter by related field</span>
<span class=n>books</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>author__name</span><span class=o>=</span><span class=s2>&quot;Jane Austen&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>

<span class=c1># Supports all comparison operators</span>
<span class=n>books</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>author__name__like</span><span class=o>=</span><span class=s2>&quot;Jane%&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>
<span class=n>books</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>author__name__in</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Jane&quot;</span><span class=p>,</span> <span class=s2>&quot;Charles&quot;</span><span class=p>])</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>

<span class=c1># Works with nested relationships</span>
<span class=n>comments</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Comment</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>book__author__name</span><span class=o>=</span><span class=s2>&quot;Charles&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>
</code></pre></div><p>This automatically adds the necessary JOINs behind the scenes.</p><h4 id=combining-with-select_related_1>Combining with select_related()</h4><p>You can combine eager loading with relationship filters:</p><div class=highlight><pre><span></span><code><span class=c1># Load related objects AND filter by them</span>
<span class=n>results</span> <span class=o>=</span> <span class=p>(</span>
    <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span>
    <span class=o>.</span><span class=n>select_related</span><span class=p>(</span><span class=s2>&quot;author&quot;</span><span class=p>)</span>
    <span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>author__name__startswith</span><span class=o>=</span><span class=s2>&quot;J&quot;</span><span class=p>)</span>
    <span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>
<span class=p>)</span>

<span class=k>for</span> <span class=n>book</span> <span class=ow>in</span> <span class=n>results</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>book</span><span class=o>.</span><span class=n>title</span><span class=si>}</span><span class=s2> by </span><span class=si>{</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>  <span class=c1># No additional query</span>
</code></pre></div><div class="admonition note"><p class=admonition-title>Note</p><p><code>select_related()</code> only works with ORM foreign keys (<code>sqliter.orm.ForeignKey</code>). For explicit foreign keys, use manual joins or separate queries.</p></div><div class="admonition tip"><p class=admonition-title>Tip</p><p>Always use <code>select_related()</code> when you know you'll need related data in a loop. Lazy loading is convenient for single objects or conditional access, but eager loading prevents N+1 queries in most scenarios.</p></div><h2 id=null-foreign-keys>Null Foreign Keys</h2><p>When a foreign key is null, accessing it returns <code>None</code> directly:</p><div class=highlight><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>Book</span><span class=p>(</span><span class=n>BaseDBModel</span><span class=p>):</span>
    <span class=n>title</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>author</span><span class=p>:</span> <span class=n>ForeignKey</span><span class=p>[</span><span class=n>Optional</span><span class=p>[</span><span class=n>Author</span><span class=p>]]</span> <span class=o>=</span> <span class=n>ForeignKey</span><span class=p>(</span>
        <span class=n>Author</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=s2>&quot;SET NULL&quot;</span>
    <span class=p>)</span>

<span class=c1># Insert book without author</span>
<span class=n>book</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>Book</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s2>&quot;Anonymous&quot;</span><span class=p>,</span> <span class=n>author</span><span class=o>=</span><span class=kc>None</span><span class=p>))</span>
<span class=n>book</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>Book</span><span class=p>,</span> <span class=n>book</span><span class=o>.</span><span class=n>pk</span><span class=p>)</span>

<span class=c1># Returns None for null FK</span>
<span class=nb>print</span><span class=p>(</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=p>)</span>  <span class=c1># None</span>
</code></pre></div><h3 id=auto-detecting-nullable-fks-preferred>Auto-Detecting Nullable FKs (Preferred)</h3><p>The recommended way to declare a nullable FK is via the type annotation. SQLiter detects <code>Optional[T]</code> and <code>T | None</code> (Python 3.10+) and sets <code>null=True</code> automatically:</p><div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>typing</span><span class=w> </span><span class=kn>import</span> <span class=n>Optional</span>

<span class=c1># Preferred — nullability declared in the type annotation:</span>
<span class=n>author</span><span class=p>:</span> <span class=n>ForeignKey</span><span class=p>[</span><span class=n>Optional</span><span class=p>[</span><span class=n>Author</span><span class=p>]]</span> <span class=o>=</span> <span class=n>ForeignKey</span><span class=p>(</span><span class=n>Author</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=s2>&quot;SET NULL&quot;</span><span class=p>)</span>
<span class=n>author</span><span class=p>:</span> <span class=n>ForeignKey</span><span class=p>[</span><span class=n>Author</span> <span class=o>|</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=n>ForeignKey</span><span class=p>(</span><span class=n>Author</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=s2>&quot;SET NULL&quot;</span><span class=p>)</span>  <span class=c1># 3.10+</span>

<span class=c1># Legacy — explicit null=True (prefer annotation-driven nullability):</span>
<span class=n>author</span><span class=p>:</span> <span class=n>ForeignKey</span><span class=p>[</span><span class=n>Author</span><span class=p>]</span> <span class=o>=</span> <span class=n>ForeignKey</span><span class=p>(</span><span class=n>Author</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=s2>&quot;SET NULL&quot;</span><span class=p>,</span> <span class=n>null</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div><div class="admonition note"><p class=admonition-title>Note</p><p>If you pass <code>null=True</code> explicitly, it always takes effect regardless of the annotation.</p><p>For reliable type-hint resolution, define ORM models at <strong>module scope</strong>. Models defined inside functions may not resolve annotations when using type aliases (e.g., <code>AuthorRef = Optional[Author]</code>), so prefer <code>null=True</code> in those cases.</p></div><h2 id=setting-foreign-key-values>Setting Foreign Key Values</h2><p>You can set foreign key values using a model instance, an integer ID, or <code>None</code>:</p><div class=highlight><pre><span></span><code><span class=c1># Using model instance</span>
<span class=n>book</span><span class=o>.</span><span class=n>author</span> <span class=o>=</span> <span class=n>author</span>

<span class=c1># Using integer ID</span>
<span class=n>book</span><span class=o>.</span><span class=n>author</span> <span class=o>=</span> <span class=mi>42</span>

<span class=c1># Setting to null (if allowed)</span>
<span class=n>book</span><span class=o>.</span><span class=n>author</span> <span class=o>=</span> <span class=kc>None</span>

<span class=c1># Any object with a `pk` attribute also works (duck-typed)</span>
<span class=n>book</span><span class=o>.</span><span class=n>author</span> <span class=o>=</span> <span class=n>some_obj_with_pk</span>

<span class=c1># Example: custom object with pk attribute</span>
<span class=k>class</span><span class=w> </span><span class=nc>AuthorReference</span><span class=p>:</span>
    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>pk</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>pk</span> <span class=o>=</span> <span class=n>pk</span>

<span class=n>book</span><span class=o>.</span><span class=n>author</span> <span class=o>=</span> <span class=n>AuthorReference</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>  <span class=c1># Works!</span>
</code></pre></div><h2 id=reverse-relationships>Reverse Relationships</h2><p>ORM foreign keys automatically create reverse relationships on the related model. This lets you query all related objects from the other side:</p><div class=highlight><pre><span></span><code><span class=c1># Get all books by an author</span>
<span class=n>author</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>Author</span><span class=p>,</span> <span class=n>author</span><span class=o>.</span><span class=n>pk</span><span class=p>)</span>
<span class=n>books</span> <span class=o>=</span> <span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>

<span class=k>for</span> <span class=n>book</span> <span class=ow>in</span> <span class=n>books</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>book</span><span class=o>.</span><span class=n>title</span><span class=p>)</span>
</code></pre></div><h3 id=available-methods>Available Methods</h3><p>Reverse relationships provide these methods:</p><div class=highlight><pre><span></span><code><span class=c1># Fetch all related objects</span>
<span class=n>books</span> <span class=o>=</span> <span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>

<span class=c1># Fetch single related object</span>
<span class=n>book</span> <span class=o>=</span> <span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>fetch_one</span><span class=p>()</span>

<span class=c1># Count related objects</span>
<span class=n>count</span> <span class=o>=</span> <span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>count</span><span class=p>()</span>

<span class=c1># Check if any exist</span>
<span class=n>has_books</span> <span class=o>=</span> <span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>exists</span><span class=p>()</span>
</code></pre></div><h3 id=filtering-reverse-relationships>Filtering Reverse Relationships</h3><p>You can filter reverse relationships before fetching:</p><div class=highlight><pre><span></span><code><span class=c1># Filter by field values</span>
<span class=n>python_books</span> <span class=o>=</span> <span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>title__like</span><span class=o>=</span><span class=s2>&quot;Python%&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>

<span class=c1># Multiple filters</span>
<span class=n>recent_python</span> <span class=o>=</span> <span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span>
    <span class=n>title__like</span><span class=o>=</span><span class=s2>&quot;Python%&quot;</span><span class=p>,</span>
    <span class=n>year__ge</span><span class=o>=</span><span class=mi>2020</span>
<span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>

<span class=c1># With limit and offset</span>
<span class=n>first_five</span> <span class=o>=</span> <span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>limit</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>
<span class=n>next_five</span> <span class=o>=</span> <span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>offset</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>limit</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>
</code></pre></div><h3 id=custom-related-name>Custom Related Name</h3><p>By default, the reverse relationship is named by pluralizing the model name (e.g., <code>Book</code> becomes <code>books</code>). If the <code>inflect</code> library is installed, it provides grammatically correct pluralization (e.g., <code>Person</code> becomes <code>people</code>, <code>Category</code> becomes <code>categories</code>). Otherwise, a simple "s" suffix is added.</p><p>You can customize this with the <code>related_name</code> parameter:</p><div class=highlight><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>Book</span><span class=p>(</span><span class=n>BaseDBModel</span><span class=p>):</span>
    <span class=n>title</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>author</span><span class=p>:</span> <span class=n>ForeignKey</span><span class=p>[</span><span class=n>Author</span><span class=p>]</span> <span class=o>=</span> <span class=n>ForeignKey</span><span class=p>(</span>
        <span class=n>Author</span><span class=p>,</span>
        <span class=n>on_delete</span><span class=o>=</span><span class=s2>&quot;CASCADE&quot;</span><span class=p>,</span>
        <span class=n>related_name</span><span class=o>=</span><span class=s2>&quot;publications&quot;</span>
    <span class=p>)</span>

<span class=c1># Now use the custom name</span>
<span class=n>author</span><span class=o>.</span><span class=n>publications</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>
</code></pre></div><h2 id=cascade-delete-behavior>Cascade Delete Behavior</h2><p>With <code>on_delete="CASCADE"</code>, deleting a parent record automatically deletes all related child records:</p><div class=highlight><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>Book</span><span class=p>(</span><span class=n>BaseDBModel</span><span class=p>):</span>
    <span class=n>title</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>author</span><span class=p>:</span> <span class=n>ForeignKey</span><span class=p>[</span><span class=n>Author</span><span class=p>]</span> <span class=o>=</span> <span class=n>ForeignKey</span><span class=p>(</span><span class=n>Author</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=s2>&quot;CASCADE&quot;</span><span class=p>)</span>

<span class=c1># Insert author with books</span>
<span class=n>author</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>Author</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;Jane&quot;</span><span class=p>,</span> <span class=n>email</span><span class=o>=</span><span class=s2>&quot;jane@example.com&quot;</span><span class=p>))</span>
<span class=n>db</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>Book</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s2>&quot;Book 1&quot;</span><span class=p>,</span> <span class=n>author</span><span class=o>=</span><span class=n>author</span><span class=p>))</span>
<span class=n>db</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>Book</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s2>&quot;Book 2&quot;</span><span class=p>,</span> <span class=n>author</span><span class=o>=</span><span class=n>author</span><span class=p>))</span>

<span class=c1># Delete author - books are automatically deleted</span>
<span class=n>db</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>Author</span><span class=p>,</span> <span class=n>author</span><span class=o>.</span><span class=n>pk</span><span class=p>)</span>

<span class=c1># No books remain</span>
<span class=k>assert</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span><span class=o>.</span><span class=n>count</span><span class=p>()</span> <span class=o>==</span> <span class=mi>0</span>
</code></pre></div><h2 id=foreign-key-actions>Foreign Key Actions</h2><p>ORM foreign keys support the same actions as explicit foreign keys:</p><table><thead><tr><th>Action</th><th>Behavior</th></tr></thead><tbody><tr><td><code>CASCADE</code></td><td>Delete/update related records</td></tr><tr><td><code>SET NULL</code></td><td>Set foreign key to NULL (requires nullable FK)</td></tr><tr><td><code>RESTRICT</code></td><td>Prevent deletion/update if referenced (default)</td></tr><tr><td><code>NO ACTION</code></td><td>Same as RESTRICT in SQLite</td></tr></tbody></table><div class=highlight><pre><span></span><code><span class=c1># CASCADE - delete books when author is deleted</span>
<span class=n>author</span><span class=p>:</span> <span class=n>ForeignKey</span><span class=p>[</span><span class=n>Author</span><span class=p>]</span> <span class=o>=</span> <span class=n>ForeignKey</span><span class=p>(</span><span class=n>Author</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=s2>&quot;CASCADE&quot;</span><span class=p>)</span>

<span class=c1># SET NULL - set author to NULL when deleted</span>
<span class=n>author</span><span class=p>:</span> <span class=n>ForeignKey</span><span class=p>[</span><span class=n>Optional</span><span class=p>[</span><span class=n>Author</span><span class=p>]]</span> <span class=o>=</span> <span class=n>ForeignKey</span><span class=p>(</span>
    <span class=n>Author</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=s2>&quot;SET NULL&quot;</span>
<span class=p>)</span>

<span class=c1># RESTRICT - prevent deletion if books exist (default)</span>
<span class=n>author</span><span class=p>:</span> <span class=n>ForeignKey</span><span class=p>[</span><span class=n>Author</span><span class=p>]</span> <span class=o>=</span> <span class=n>ForeignKey</span><span class=p>(</span><span class=n>Author</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=s2>&quot;RESTRICT&quot;</span><span class=p>)</span>
</code></pre></div><h2 id=common-issues-and-gotchas>Common Issues and Gotchas</h2><h3 id=database-context-not-set>Database Context Not Set</h3><p>Lazy loading requires <code>db_context</code> to be set on the model instance. SQLiter automatically sets this for objects returned from database operations, but manually created instances need it set explicitly:</p><div class=highlight><pre><span></span><code><span class=c1># ❌ Won&#39;t work - no db_context</span>
<span class=n>book</span> <span class=o>=</span> <span class=n>Book</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s2>&quot;Manual Book&quot;</span><span class=p>,</span> <span class=n>author_id</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>  <span class=c1># AttributeError: &#39;NoneType&#39; has no attribute &#39;name&#39;</span>

<span class=c1># ✅ Works - db_context set manually</span>
<span class=n>book</span> <span class=o>=</span> <span class=n>Book</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s2>&quot;Manual Book&quot;</span><span class=p>,</span> <span class=n>author_id</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=n>book</span><span class=o>.</span><span class=n>db_context</span> <span class=o>=</span> <span class=n>db</span>
<span class=nb>print</span><span class=p>(</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>  <span class=c1># Now works!</span>

<span class=c1># ✅ Automatic - db operations set db_context</span>
<span class=n>book</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>Book</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>  <span class=c1># Works automatically</span>
</code></pre></div><p><strong>When <code>db_context</code> is set automatically:</strong></p><ul><li><code>db.insert()</code> - Returns instance with <code>db_context</code> set</li><li><code>db.get()</code> - Returns instance with <code>db_context</code> set</li><li><code>db.select().fetch_all()</code> - All instances have <code>db_context</code> set</li><li><code>db.select().fetch_one()</code> - Instance has <code>db_context</code> set</li></ul><p><strong>When you need to set it manually:</strong></p><ul><li>Creating instances with <code>Model(...)</code> constructor</li><li>Deserializing objects from JSON or other sources</li><li>Using objects in contexts where they weren't retrieved from the database</li></ul><h3 id=lazyloader-not-hashable>LazyLoader Not Hashable</h3><p>Foreign key fields return <code>LazyLoader</code> proxy objects, which are <strong>not hashable</strong>. This means you cannot use them in sets or as dictionary keys:</p><div class=highlight><pre><span></span><code><span class=n>book</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>Book</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>

<span class=c1># ❌ Won&#39;t work - LazyLoader is unhashable</span>
<span class=n>authors_set</span> <span class=o>=</span> <span class=p>{</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=p>}</span>  <span class=c1># TypeError: unhashable type: &#39;LazyLoader&#39;</span>

<span class=c1># ❌ Won&#39;t work - Can&#39;t use as dict key</span>
<span class=n>author_map</span> <span class=o>=</span> <span class=p>{</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=p>:</span> <span class=n>book</span><span class=p>}</span>  <span class=c1># TypeError: unhashable type: &#39;LazyLoader&#39;</span>

<span class=c1># ✅ Works - Access the underlying object&#39;s pk</span>
<span class=n>authors_set</span> <span class=o>=</span> <span class=p>{</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>pk</span><span class=p>}</span>

<span class=c1># ✅ Works - Store the ID instead</span>
<span class=n>author_map</span> <span class=o>=</span> <span class=p>{</span><span class=n>book</span><span class=o>.</span><span class=n>author_id</span><span class=p>:</span> <span class=n>book</span><span class=p>}</span>

<span class=c1># ✅ Works - Build dict from author objects after loading</span>
<span class=n>authors</span> <span class=o>=</span> <span class=p>[</span><span class=n>book</span><span class=o>.</span><span class=n>author</span> <span class=k>for</span> <span class=n>book</span> <span class=ow>in</span> <span class=n>books</span><span class=p>]</span>  <span class=c1># Triggers loading</span>
<span class=n>author_map</span> <span class=o>=</span> <span class=p>{</span><span class=n>author</span><span class=o>.</span><span class=n>pk</span><span class=p>:</span> <span class=n>author</span> <span class=k>for</span> <span class=n>author</span> <span class=ow>in</span> <span class=n>authors</span><span class=p>}</span>
</code></pre></div><p><strong>Why unhashable?</strong> <code>LazyLoader</code> uses mutable equality (based on the cached object), which violates Python's hash/equality contract. Setting <code>__hash__ = None</code> prevents subtle bugs where two "equal" objects have different hashes.</p><h3 id=stale-cache-after-manual-updates>Stale Cache After Manual Updates</h3><p>If you modify the foreign key ID field directly and then access the relationship, the cache is automatically cleared. However, external database changes won't be reflected:</p><div class=highlight><pre><span></span><code><span class=n>book</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>Book</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<span class=n>author_name</span> <span class=o>=</span> <span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span>  <span class=c1># Caches author object</span>

<span class=c1># Another process/connection updates the author record</span>
<span class=c1># book.author still returns cached (stale) data</span>

<span class=c1># ✅ To get fresh data, re-fetch the book</span>
<span class=n>book</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>Book</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<span class=n>author_name</span> <span class=o>=</span> <span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span>  <span class=c1># Fetches latest author data</span>
</code></pre></div><h3 id=foreign-keys-in-filters>Foreign Keys in Filters</h3><p>When filtering by foreign key relationships, you have several options:</p><div class=highlight><pre><span></span><code><span class=c1># ✅ Works - filter by _id field</span>
<span class=n>books</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>author_id</span><span class=o>=</span><span class=n>author</span><span class=o>.</span><span class=n>pk</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>

<span class=c1># ✅ Also works - use the ID directly</span>
<span class=n>books</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>author_id</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>

<span class=c1># ✅ NEW - Filter by related model fields (requires ORM FK)</span>
<span class=n>books</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>author__name</span><span class=o>=</span><span class=s2>&quot;Jane Austen&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>
</code></pre></div><p>The relationship filter traversal (e.g., <code>author__name</code>) only works with <code>sqliter.orm.ForeignKey</code> and automatically joins the related tables.</p><h2 id=complete-example>Complete Example</h2><p>Here's a complete example demonstrating ORM foreign keys with lazy loading and reverse relationships:</p><div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sqliter</span><span class=w> </span><span class=kn>import</span> <span class=n>SqliterDB</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sqliter.orm</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseDBModel</span><span class=p>,</span> <span class=n>ForeignKey</span>

<span class=k>class</span><span class=w> </span><span class=nc>Author</span><span class=p>(</span><span class=n>BaseDBModel</span><span class=p>):</span>
    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>email</span><span class=p>:</span> <span class=nb>str</span>

<span class=k>class</span><span class=w> </span><span class=nc>Book</span><span class=p>(</span><span class=n>BaseDBModel</span><span class=p>):</span>
    <span class=n>title</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>year</span><span class=p>:</span> <span class=nb>int</span>
    <span class=n>author</span><span class=p>:</span> <span class=n>ForeignKey</span><span class=p>[</span><span class=n>Author</span><span class=p>]</span> <span class=o>=</span> <span class=n>ForeignKey</span><span class=p>(</span><span class=n>Author</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=s2>&quot;CASCADE&quot;</span><span class=p>)</span>

<span class=c1># Create database and tables</span>
<span class=n>db</span> <span class=o>=</span> <span class=n>SqliterDB</span><span class=p>(</span><span class=s2>&quot;:memory:&quot;</span><span class=p>)</span>
<span class=n>db</span><span class=o>.</span><span class=n>create_table</span><span class=p>(</span><span class=n>Author</span><span class=p>)</span>
<span class=n>db</span><span class=o>.</span><span class=n>create_table</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span>

<span class=c1># Insert an author</span>
<span class=n>author</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>Author</span><span class=p>(</span>
    <span class=n>name</span><span class=o>=</span><span class=s2>&quot;Jane Austen&quot;</span><span class=p>,</span>
    <span class=n>email</span><span class=o>=</span><span class=s2>&quot;jane@example.com&quot;</span>
<span class=p>))</span>

<span class=c1># Insert books - can use model instance directly</span>
<span class=n>book1</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>Book</span><span class=p>(</span>
    <span class=n>title</span><span class=o>=</span><span class=s2>&quot;Pride and Prejudice&quot;</span><span class=p>,</span>
    <span class=n>year</span><span class=o>=</span><span class=mi>1813</span><span class=p>,</span>
    <span class=n>author</span><span class=o>=</span><span class=n>author</span>
<span class=p>))</span>
<span class=n>book2</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>Book</span><span class=p>(</span>
    <span class=n>title</span><span class=o>=</span><span class=s2>&quot;Sense and Sensibility&quot;</span><span class=p>,</span>
    <span class=n>year</span><span class=o>=</span><span class=mi>1811</span><span class=p>,</span>
    <span class=n>author</span><span class=o>=</span><span class=n>author</span>
<span class=p>))</span>

<span class=c1># Lazy loading - access author through book</span>
<span class=n>book</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>Book</span><span class=p>,</span> <span class=n>book1</span><span class=o>.</span><span class=n>pk</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;&#39;</span><span class=si>{</span><span class=n>book</span><span class=o>.</span><span class=n>title</span><span class=si>}</span><span class=s2>&#39; by </span><span class=si>{</span><span class=n>book</span><span class=o>.</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=c1># Output: &#39;Pride and Prejudice&#39; by Jane Austen</span>

<span class=c1># Reverse relationship - access books through author</span>
<span class=n>author</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>Author</span><span class=p>,</span> <span class=n>author</span><span class=o>.</span><span class=n>pk</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>author</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> wrote </span><span class=si>{</span><span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>count</span><span class=p>()</span><span class=si>}</span><span class=s2> books:&quot;</span><span class=p>)</span>
<span class=k>for</span> <span class=n>book</span> <span class=ow>in</span> <span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>():</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  - </span><span class=si>{</span><span class=n>book</span><span class=o>.</span><span class=n>title</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>book</span><span class=o>.</span><span class=n>year</span><span class=si>}</span><span class=s2>)&quot;</span><span class=p>)</span>
<span class=c1># Output:</span>
<span class=c1># Jane Austen wrote 2 books:</span>
<span class=c1>#   - Pride and Prejudice (1813)</span>
<span class=c1>#   - Sense and Sensibility (1811)</span>

<span class=c1># Filter reverse relationship</span>
<span class=n>early_books</span> <span class=o>=</span> <span class=n>author</span><span class=o>.</span><span class=n>books</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>year__lt</span><span class=o>=</span><span class=mi>1812</span><span class=p>)</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Books before 1812: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>early_books</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=c1># Output: Books before 1812: 1</span>

<span class=c1># Cascade delete</span>
<span class=n>db</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>Author</span><span class=p>,</span> <span class=n>author</span><span class=o>.</span><span class=n>pk</span><span class=p>)</span>
<span class=k>assert</span> <span class=n>db</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>Book</span><span class=p>)</span><span class=o>.</span><span class=n>count</span><span class=p>()</span> <span class=o>==</span> <span class=mi>0</span>  <span class=c1># All books deleted</span>
</code></pre></div></article></div><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div></main><footer class=md-footer><nav class="md-footer__inner md-grid" aria-label=Footer><a href=../explicit/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Explicit Foreign Keys"><div class="md-footer__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg></div><div class=md-footer__title><span class=md-footer__direction> Previous </span><div class=md-ellipsis> Explicit Foreign Keys </div></div></a><a href=../../many-to-many/ class="md-footer__link md-footer__link--next" aria-label="Next: Many-to-Many"><div class=md-footer__title><span class=md-footer__direction> Next </span><div class=md-ellipsis> Many-to-Many </div></div><div class="md-footer__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg></div></a></nav><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright><div class=md-copyright__highlight> © 2024-2026 Grant Ramsay (Seapagan) </div> Made with <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener"> Material for MkDocs </a></div><div class=md-social><a href="https://github.com/seapagan/simple-toml-settings" target="_blank" rel="noopener" title="github.com" class="md-social__link"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg></a><a href="https://twitter.com/gnramsay_dev" target="_blank" rel="noopener" title="twitter.com" class="md-social__link"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg></a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><div class=md-consent data-md-component=consent id=__consent hidden><div class=md-consent__overlay></div><aside class=md-consent__inner><form class="md-consent__form md-grid md-typeset" name=consent><h4>Cookie consent</h4><p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p><input class=md-toggle type=checkbox id=__settings><div class=md-consent__settings><ul class=task-list><li class=task-list-item><label class=task-list-control><input type=checkbox name=github checked><span class=task-list-indicator></span> GitHub </label></li></ul></div><div class=md-consent__controls><button class="md-button md-button--primary">Accept</button><label class=md-button for=__settings>Manage settings</label></div></form></aside></div><script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script><script id=__config type=application/json>{"base": "../../..", "features": ["navigation.footer", "navigation.expand", "navigation.tabs", "navigation.sections", "navigation.indexes", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script><script src=../../../assets/javascripts/bundle.13a4f30d.min.js></script><script src="../../../assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script></body></html>